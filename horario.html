<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Elegir Horario</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background-image: url('Fondo-index.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    nav {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.7);
      padding: 10px 20px;
      border-radius: 20px;
      z-index: 9999;
    }
    nav a {
      margin: 0 10px;
      text-decoration: none;
      color: #b35b8c;
      font-weight: 600;
    }

    h1 {
      color: #b35b8c;
      margin-bottom: 20px;
    }

    .horarios {
      background-color: #f8d4f0;
      border-radius: 30px;
      padding: 30px;
      display: flex;
      gap: 30px;
      opacity: 0.9;
      flex-wrap: wrap;
      justify-content: center;
    }

    .hora {
      background-color: #fde7f4;
      padding: 30px 50px;
      border-radius: 20px;
      font-size: 2em;
      color: #b35b8c;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
    }

    .hora:hover {
      background-color: #fbcfe8;
    }

    .ocupado {
      background-color: #ccc !important;
      color: #888 !important;
      cursor: not-allowed;
      pointer-events: none;
    }

    .confirmar {
      margin-top: 30px;
      font-size: 1.2em;
      color: #b35b8c;
    }
  
nav {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 9999;
}

.menu-toggle {
  display: none;
  font-size: 2em;
  cursor: pointer;
  color: #b35b8c;
}

.menu {
  background: rgba(255, 255, 255, 0.8);
  list-style: none;
  padding: 10px 20px;
  border-radius: 20px;
  display: flex;
  gap: 10px;
}

.menu li a {
  text-decoration: none;
  color: #b35b8c;
  font-weight: 600;
}

@media (max-width: 768px) {
  .menu-toggle {
    display: block;
  }

  .menu {
    flex-direction: column;
    display: none;
    position: absolute;
    top: 50px;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 0 0 0 20px;
  }

  .menu.show {
    display: flex;
  }
}

</style>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDqC_XW-S9z7kTOodf01oi9xCYdbmVVtm0",
      authDomain: "orisualisados.firebaseapp.com",
      projectId: "orisualisados",
      storageBucket: "orisualisados.firebasestorage.app",
      messagingSenderId: "626633649536",
      appId: "1:626633649536:web:cb97b044ee0521d9462565",
      measurementId: "G-XBW4NQJFQD"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const mensaje = document.getElementById("mensajeConfirmacion");
    const params = new URLSearchParams(window.location.search);
    const dia = params.get("dia");
    const mes = params.get("mes");
    const año = params.get("año");

    const horarios = ["9:00", "9:30", "13:00", "13:30"];

    async function cargarHorarios() {
      const reservasDia = [];

      try {
        const q = query(collection(db, "reservas"),
          where("dia", "==", dia),
          where("mes", "==", mes),
          where("año", "==", año)
        );

        const snapshot = await getDocs(q);
        snapshot.forEach(doc => {
          reservasDia.push(doc.data().hora);
        });

      } catch (error) {
        console.error("Error al cargar horarios desde Firebase:", error);
      }

      horarios.forEach(hora => {
        const id = "hora" + hora.replace(":", "");
        const elemento = document.getElementById(id);
        if (reservasDia.includes(hora)) {
          elemento.classList.add("ocupado");
        }
      });
    }

    window.confirmar = function(hora) {
      const id = 'hora' + hora.replace(':', '');
      if (document.getElementById(id).classList.contains('ocupado')) {
        mensaje.textContent = "Este horario ya está ocupado.";
        return;
      }
      window.location.href = `datos.html?dia=${dia}&mes=${mes}&año=${año}&hora=${hora}`;
    }

    window.addEventListener("DOMContentLoaded", () => {
      cargarHorarios();
    });
  </script>
</head>

<body>
  <nav><nav>
  <div class="menu-toggle" onclick="toggleMenu()">☰</div>
  <ul class="menu" id="menu">
    <li><a href="index.html">Inicio</a></li>
    <li><a href="calendario.html">Reservar</a></li>
    <li><a href="informacion.html">Información</a></li>
    <li><a href="lista-reservas.html">Reservas</a></li>
  </ul>
</nav></nav>

  <h1>Elige tu Horario</h1>
  <div class="horarios">
    <div id="hora900" class="hora" onclick="confirmar('9:00')">9:00</div>
    <div id="hora930" class="hora" onclick="confirmar('9:30')">9:30</div>
    <div id="hora1300" class="hora" onclick="confirmar('13:00')">13:00</div>
    <div id="hora1330" class="hora" onclick="confirmar('13:30')">13:30</div>
  </div>
  <div class="confirmar" id="mensajeConfirmacion"></div>

<script>
  function toggleMenu() {
    const menu = document.getElementById("menu");
    menu.classList.toggle("show");
  }
</script>

</body>
</html>
